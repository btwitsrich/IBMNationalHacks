package com.mycompany;

import java.io.*;
import java.nio.file.*;
import java.util.regex.*;

public class VulnerabilityScanner {

    public static void main(String[] args) throws IOException {
        Path sourcePath = Paths.get("src/main/java/com/mycompany/App.java");
        String content = Files.readString(sourcePath);

        Pattern hardcodedPasswordPattern = Pattern.compile("password\\s*=\\s*\".*\"");

        Matcher matcher = hardcodedPasswordPattern.matcher(content);

        if (matcher.find()) {
            System.out.println("ðŸ”´ Vulnerability Found: Hardcoded password at line " + 
                (content.substring(0, matcher.start()).split("\n").length));
        } else {
            System.out.println("âœ… No hardcoded password found.");
        }
    }
}
